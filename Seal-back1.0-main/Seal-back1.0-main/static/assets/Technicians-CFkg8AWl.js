import{_ as b,c as d,a as o,b as _,f as s,e as r,v as p,t as n,F as y,j as h,h as g,z as w,q as F,l as v,o as f}from"./index-BvItkERQ.js";const C={name:"Technicians",data(){return{technicians:[],loading:!0,error:null,searchQuery:"",showEditModal:!1,isSubmitting:!1,editForm:{id:null,username:"",first_name:"",last_name:"",email:"",phone_number:"",company_name:"",department:""}}},computed:{filteredTechnicians(){if(!this.searchQuery)return this.technicians;const i=this.searchQuery.toLowerCase();return this.technicians.filter(t=>t.first_name.toLowerCase().includes(i)||t.last_name.toLowerCase().includes(i)||t.technician_code.toLowerCase().includes(i)||t.username.toLowerCase().includes(i)||t.email.toLowerCase().includes(i))}},async created(){await this.fetchTechnicians()},methods:{async fetchTechnicians(){try{const i=await v.get("/api/technician/list");this.technicians=i.data,this.error=null}catch(i){console.error("Error fetching technicians:",i),this.error="ไม่สามารถโหลดข้อมูลช่างได้"}finally{this.loading=!1}},editTechnician(i){this.editForm={id:i.id,username:i.username,first_name:i.first_name,last_name:i.last_name,email:i.email,phone_number:i.phone_number,company_name:i.company_name,department:i.department},this.showEditModal=!0},closeEditModal(){this.showEditModal=!1,this.editForm={id:null,username:"",first_name:"",last_name:"",email:"",phone_number:"",company_name:"",department:""}},async submitEdit(){var i,t;try{this.isSubmitting=!0,await v.put(`/api/technician/update/${this.editForm.id}`,this.editForm),await this.fetchTechnicians(),this.closeEditModal(),this.$swal({icon:"success",title:"แก้ไขข้อมูลสำเร็จ",showConfirmButton:!1,timer:1500})}catch(u){console.error("Edit error:",u),this.$swal({icon:"error",title:"ไม่สามารถแก้ไขข้อมูลได้",text:((t=(i=u.response)==null?void 0:i.data)==null?void 0:t.message)||"กรุณาลองใหม่อีกครั้ง",confirmButtonText:"ตกลง"})}finally{this.isSubmitting=!1}},async confirmDelete(i){var t,u;if(i.in_progress_count>0){alert("ไม่สามารถลบช่างที่มีงานค้างอยู่ได้");return}if(confirm(`ต้องการลบช่าง ${i.first_name} ${i.last_name} ใช่หรือไม่?`))try{await v.delete(`/api/technician/delete/${i.id}`),await this.fetchTechnicians(),this.$swal({icon:"success",title:"ลบช่างสำเร็จ",showConfirmButton:!1,timer:1500})}catch(m){console.error("Delete error:",m),this.$swal({icon:"error",title:"ไม่สามารถลบช่างได้",text:((u=(t=m.response)==null?void 0:t.data)==null?void 0:u.message)||"กรุณาลองใหม่อีกครั้ง",confirmButtonText:"ตกลง"})}}}},E={class:"technicians"},k={class:"header"},x={class:"header-content"},T={class:"header-actions"},M={class:"search-box"},V={class:"content"},S={key:0,class:"loading-state"},q={key:1,class:"error-state"},B={key:2,class:"technicians-list"},L={class:"tech-info"},U={class:"details"},D={class:"employee-id"},Q={class:"username"},N={class:"company-info"},j={class:"contact-info"},z={class:"actions"},I=["onClick"],A=["onClick","disabled"],G={key:0,class:"modal-overlay"},H={class:"modal-content"},J={class:"modal-header"},K={class:"form-grid"},O={class:"form-column"},P={class:"form-group"},R={class:"form-group"},W={class:"form-group"},X={class:"form-column"},Y={class:"form-group"},Z={class:"form-group"},$={class:"form-group"},tt={class:"modal-actions"},ot=["disabled"];function at(i,t,u,m,e,l){return f(),d("div",E,[o("div",k,[o("div",x,[t[13]||(t[13]=o("h1",null,[o("i",{class:"fas fa-users"}),s(" รายชื่อช่างทั้งหมด")],-1)),o("div",T,[o("div",M,[t[11]||(t[11]=o("i",{class:"fas fa-search"},null,-1)),r(o("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>e.searchQuery=a),placeholder:"ค้นหาช่าง..."},null,512),[[p,e.searchQuery]])]),o("button",{class:"add-btn",onClick:t[1]||(t[1]=a=>i.$router.push("/register-technician"))},t[12]||(t[12]=[o("i",{class:"fas fa-user-plus"},null,-1),s(" เพิ่มช่าง ")]))])])]),o("div",V,[e.loading?(f(),d("div",S,t[14]||(t[14]=[o("i",{class:"fas fa-spinner fa-spin"},null,-1),s(" กำลังโหลดข้อมูล... ")]))):e.error?(f(),d("div",q,[t[15]||(t[15]=o("i",{class:"fas fa-exclamation-circle"},null,-1)),s(" "+n(e.error),1)])):(f(),d("div",B,[(f(!0),d(y,null,h(l.filteredTechnicians,a=>(f(),d("div",{key:a.id,class:"tech-card"},[o("div",L,[t[20]||(t[20]=o("div",{class:"avatar"},[o("i",{class:"fas fa-user"})],-1)),o("div",U,[o("h3",null,n(a.first_name)+" "+n(a.last_name),1),o("p",D,"รหัสพนักงาน: "+n(a.technician_code),1),o("p",Q,"ชื่อผู้ใช้: "+n(a.username),1),o("div",N,[o("p",null,[t[16]||(t[16]=o("i",{class:"fas fa-building"},null,-1)),s(" "+n(a.company_name),1)]),o("p",null,[t[17]||(t[17]=o("i",{class:"fas fa-briefcase"},null,-1)),s(" "+n(a.department),1)])]),o("div",j,[o("span",null,[t[18]||(t[18]=o("i",{class:"fas fa-phone"},null,-1)),s(" "+n(a.phone_number),1)]),o("span",null,[t[19]||(t[19]=o("i",{class:"fas fa-envelope"},null,-1)),s(" "+n(a.email),1)])])])]),o("div",z,[o("button",{class:"action-btn edit",onClick:c=>l.editTechnician(a)},t[21]||(t[21]=[o("i",{class:"fas fa-edit"},null,-1),s(" แก้ไข ")]),8,I),o("button",{class:"action-btn delete",onClick:c=>l.confirmDelete(a),disabled:a.in_progress_count>0},t[22]||(t[22]=[o("i",{class:"fas fa-trash-alt"},null,-1),s(" ลบ ")]),8,A)])]))),128))]))]),e.showEditModal?(f(),d("div",G,[o("div",H,[o("div",J,[t[24]||(t[24]=o("h2",null,[o("i",{class:"fas fa-user-edit"}),s(" แก้ไขข้อมูลช่าง")],-1)),o("button",{class:"close-btn",onClick:t[2]||(t[2]=(...a)=>l.closeEditModal&&l.closeEditModal(...a))},t[23]||(t[23]=[o("i",{class:"fas fa-times"},null,-1)]))]),o("form",{onSubmit:t[10]||(t[10]=g((...a)=>l.submitEdit&&l.submitEdit(...a),["prevent"])),class:"edit-form"},[o("div",K,[o("div",O,[o("div",P,[t[25]||(t[25]=o("label",null,[o("i",{class:"fas fa-user"}),s(" ชื่อจริง")],-1)),r(o("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>e.editForm.first_name=a),type:"text",required:""},null,512),[[p,e.editForm.first_name]])]),o("div",R,[t[26]||(t[26]=o("label",null,[o("i",{class:"fas fa-envelope"}),s(" อีเมล")],-1)),r(o("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>e.editForm.email=a),type:"email",required:""},null,512),[[p,e.editForm.email]])]),o("div",W,[t[27]||(t[27]=o("label",null,[o("i",{class:"fas fa-building"}),s(" ชื่อบริษัท")],-1)),r(o("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>e.editForm.company_name=a),type:"text",required:""},null,512),[[p,e.editForm.company_name]])])]),o("div",X,[o("div",Y,[t[28]||(t[28]=o("label",null,[o("i",{class:"fas fa-user"}),s(" นามสกุล")],-1)),r(o("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>e.editForm.last_name=a),type:"text",required:""},null,512),[[p,e.editForm.last_name]])]),o("div",Z,[t[29]||(t[29]=o("label",null,[o("i",{class:"fas fa-phone"}),s(" เบอร์โทรศัพท์")],-1)),r(o("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>e.editForm.phone_number=a),type:"tel",required:""},null,512),[[p,e.editForm.phone_number]])]),o("div",$,[t[31]||(t[31]=o("label",null,[o("i",{class:"fas fa-map-marker-alt"}),s(" การไฟฟ้าสังกัด")],-1)),r(o("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>e.editForm.department=a),required:""},t[30]||(t[30]=[F('<option value="กฟจ.นครราชสีมา" data-v-f0fad283>กฟจ.นครราชสีมา</option><option value="กฟจ.นครราชสีมา2" data-v-f0fad283>กฟจ.นครราชสีมา2</option><option value="กฟจ.นครราชสีมา3" data-v-f0fad283>กฟจ.นครราชสีมา3</option><option value="กฟอ.ปากช่อง" data-v-f0fad283>กฟอ.ปากช่อง</option><option value="กฟอ.สีคิ้ว" data-v-f0fad283>กฟอ.สีคิ้ว</option><option value="กฟอ.บัวใหญ่" data-v-f0fad283>กฟอ.บัวใหญ่</option><option value="กฟอ.โชคชัย" data-v-f0fad283>กฟอ.โชคชัย</option><option value="กฟอ.พิมาย" data-v-f0fad283>กฟอ.พิมาย</option><option value="กฟอ.ปักธงชัย" data-v-f0fad283>กฟอ.ปักธงชัย</option><option value="กฟส.โนนสูง" data-v-f0fad283>กฟส.โนนสูง</option><option value="กฟส.จอหอ" data-v-f0fad283>กฟส.จอหอ</option><option value="กฟส.โนนไทย" data-v-f0fad283>กฟส.โนนไทย</option><option value="กฟส.สูงเนิน" data-v-f0fad283>กฟส.สูงเนิน</option><option value="กฟส.ด่านขุนทด" data-v-f0fad283>กฟส.ด่านขุนทด</option><option value="กฟส.ประทาย" data-v-f0fad283>กฟส.ประทาย</option><option value="กฟส.คง" data-v-f0fad283>กฟส.คง</option><option value="กฟส.ครบุรี" data-v-f0fad283>กฟส.ครบุรี</option><option value="กฟส.หนองบุญมาก" data-v-f0fad283>กฟส.หนองบุญมาก</option><option value="กฟส.เสิงสาง" data-v-f0fad283>กฟส.เสิงสาง</option><option value="กฟส.ชุมพวง" data-v-f0fad283>กฟส.ชุมพวง</option><option value="กฟส.จักราช" data-v-f0fad283>กฟส.จักราช</option><option value="กฟส.วังน้ำเขียว" data-v-f0fad283>กฟส.วังน้ำเขียว</option><option value="กฟจ.ชัยภูมิ" data-v-f0fad283>กฟจ.ชัยภูมิ</option><option value="กฟอ.ภูเขียว" data-v-f0fad283>กฟอ.ภูเขียว</option><option value="กฟส.แก้งคร้อ" data-v-f0fad283>กฟส.แก้งคร้อ</option><option value="กฟส.จัตุรัส" data-v-f0fad283>กฟส.จัตุรัส</option><option value="กฟส.หนองบัวแดง" data-v-f0fad283>กฟส.หนองบัวแดง</option><option value="กฟส.บำเหน็จณรงค์" data-v-f0fad283>กฟส.บำเหน็จณรงค์</option><option value="กฟส.เกษตรสมบูรณ์" data-v-f0fad283>กฟส.เกษตรสมบูรณ์</option><option value="กฟจ.บุรีรัมย์" data-v-f0fad283>กฟจ.บุรีรัมย์</option><option value="กฟอ.นางรอง" data-v-f0fad283>กฟอ.นางรอง</option><option value="กฟส.คูเมือง" data-v-f0fad283>กฟส.คูเมือง</option><option value="กฟส.กระสัง" data-v-f0fad283>กฟส.กระสัง</option><option value="กฟส.สตึก" data-v-f0fad283>กฟส.สตึก</option><option value="กฟส.ลำปลายมาศ" data-v-f0fad283>กฟส.ลำปลายมาศ</option><option value="กฟส.พุทไธสง" data-v-f0fad283>กฟส.พุทไธสง</option><option value="กฟส.ประโคนชัย" data-v-f0fad283>กฟส.ประโคนชัย</option><option value="กฟส.หนองกี่" data-v-f0fad283>กฟส.หนองกี่</option><option value="กฟส.ละหานทราย" data-v-f0fad283>กฟส.ละหานทราย</option><option value="กฟส.บ้านกรวด" data-v-f0fad283>กฟส.บ้านกรวด</option><option value="กฟจ.สุรินทร์" data-v-f0fad283>กฟจ.สุรินทร์</option><option value="กฟอ.ปราสาท" data-v-f0fad283>กฟอ.ปราสาท</option><option value="กฟส.ศีขรภูมิ" data-v-f0fad283>กฟส.ศีขรภูมิ</option><option value="กฟส.ท่าตูม" data-v-f0fad283>กฟส.ท่าตูม</option><option value="กฟส.รัตนบุรี" data-v-f0fad283>กฟส.รัตนบุรี</option><option value="กฟส.สังขะ" data-v-f0fad283>กฟส.สังขะ</option>',46)]),512),[[w,e.editForm.department]])])])]),o("div",tt,[o("button",{type:"button",class:"cancel-btn",onClick:t[9]||(t[9]=(...a)=>l.closeEditModal&&l.closeEditModal(...a))},t[32]||(t[32]=[o("i",{class:"fas fa-times"},null,-1),s(" ยกเลิก ")])),o("button",{type:"submit",class:"save-btn",disabled:e.isSubmitting},[t[33]||(t[33]=o("i",{class:"fas fa-save"},null,-1)),s(" "+n(e.isSubmitting?"กำลังบันทึก...":"บันทึก"),1)],8,ot)])],32)])])):_("",!0)])}const et=b(C,[["render",at],["__scopeId","data-v-f0fad283"]]);export{et as default};
