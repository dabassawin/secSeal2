import{_ as B,c as d,a as t,f as b,n as g,t as o,b as h,e as F,v as p,F as U,j as L,l as C,m as r,p as P,o as c}from"./index-BvItkERQ.js";const V={name:"SealList",props:{status:{type:String,default:"พร้อมใช้งาน"}},setup(a){const e=r([]),_=r(!0),s=r(null),S=r(""),i=r(!1),l=r({dateRange:"all",sortBy:"date-desc"}),y=r(null),m=r("all"),v=r(!1),w=r(""),I=new Date().toISOString().split("T")[0],x={พร้อมใช้งาน:{title:"Seal พร้อมใช้งาน",description:"รายการ Seal ที่พร้อมใช้งาน",icon:"fas fa-check-circle"},จ่าย:{title:"Seal ที่จ่ายแล้ว",description:"รายการ Seal ที่จ่ายแล้วทั้งหมด",icon:"fas fa-share-alt"},ติดตั้งแล้ว:{title:"Seal ที่ติดตั้งแล้ว",description:"รายการ Seal ที่ติดตั้งแล้ว",icon:"fas fa-tools"},ใช้งานแล้ว:{title:"Seal ที่ใช้งานแล้ว",description:"รายการ Seal ที่ใช้งานแล้ว",icon:"fas fa-check-double"}},T=P(()=>{let f=[...e.value];if(S.value&&(f=f.filter(n=>n.seal_number.toLowerCase().includes(S.value.toLowerCase()))),m.value!=="all"){const n=new Date;n.setHours(0,0,0,0);const u=new Date(n);u.setDate(u.getDate()-1),f=f.filter(M=>{const D=new Date(M.created_at);switch(D.setHours(0,0,0,0),m.value){case"today":return D.getTime()===n.getTime();case"yesterday":return D.getTime()===u.getTime();case"custom":const k=new Date(w.value);return k.setHours(0,0,0,0),D.getTime()===k.getTime();default:return!0}})}return f.sort((n,u)=>{switch(l.value.sortBy){case"date-desc":return new Date(u.created_at)-new Date(n.created_at);case"date-asc":return new Date(n.created_at)-new Date(u.created_at);case"code":return n.seal_number.localeCompare(u.seal_number);default:return 0}}),f});return{seals:e,loading:_,error:s,searchQuery:S,showFilterMenu:i,filters:l,statusInfo:x,filteredSeals:T,selectedSeal:y,dateFilter:m,showDatePicker:v,selectedDate:w,today:I}},methods:{async fetchSeals(){this.loading=!0,this.error=null;try{const a=await C.get(`/api/seals/status/${this.status}`);this.seals=a.data}catch(a){console.error("Error fetching seals:",a),this.error="ไม่สามารถโหลดข้อมูลได้"}finally{this.loading=!1}},formatDate(a){const e=new Date(a);return new Intl.DateTimeFormat("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)},toggleFilterMenu(){this.showFilterMenu=!this.showFilterMenu},hideFilterMenu(){this.showFilterMenu=!1},resetFilters(){this.filters={dateRange:"all",sortBy:"date-desc"}},applyFilters(){this.hideFilterMenu()},goToDistribute(a){this.$router.push({name:"distribute",state:{seal:a}})},viewDetails(a){this.$router.push({name:"seal-details",params:{id:a.id}})},exportData(){console.log("Export data")},getStatusText(a){return{available:"พร้อมใช้งาน",distributed:"แจกจ่ายแล้ว",installed:"ติดตั้งแล้ว",used:"ใช้งานแล้ว"}[a]||a},async fetchSealDetails(a){try{const e=await C.get(`/api/seals/${a}/status/${this.status}`);this.selectedSeal=e.data}catch(e){console.error("Error fetching seal details:",e)}},applyDateFilter(){this.dateFilter="custom",this.showDatePicker=!1},openImage(a){a&&window.open(a,"_blank")},getImageUrl(a){return a?`http://192.168.2.6s:3000${a}`:""}},computed:{currentStatus(){return this.status},filteredSeals(){let a=[...this.seals];return a=a.filter(e=>e.status===this.status),a}},watch:{currentStatus:{immediate:!0,handler(){this.fetchSeals()}}}},E={class:"seal-list"},H={class:"header"},N={class:"header-content"},Q={class:"subtitle"},R={class:"content"},j={class:"toolbar"},z={class:"search-box"},O={class:"filter-buttons"},q={key:0,class:"date-picker-modal"},A={class:"modal-content"},G=["max"],J={class:"modal-actions"},K={class:"seals-list"},W={class:"seal-info"},X={class:"seal-number"},Y=["onClick"],Z={key:0,class:"inline-details"},$={class:"details-content"},ee={class:"details-info"},te={class:"detail-item"},se={class:"detail-item"},ae={class:"detail-item"},le={class:"detail-item"},ie={class:"detail-item"},re={key:0,class:"installation-images"},ne={class:"images-grid"},oe=["src"],de=["src"];function ce(a,e,_,s,S,i){return c(),d("div",E,[t("div",H,[t("div",N,[t("h1",null,[t("i",{class:g(s.statusInfo[i.currentStatus].icon)},null,2),b(" "+o(s.statusInfo[i.currentStatus].title),1)]),t("p",Q,o(s.statusInfo[i.currentStatus].description),1)])]),t("div",R,[t("div",j,[t("div",z,[e[11]||(e[11]=t("i",{class:"fas fa-search"},null,-1)),F(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>s.searchQuery=l),placeholder:"ค้นหารหัส Seal..."},null,512),[[p,s.searchQuery]])]),t("div",O,[t("button",{class:g(["filter-btn",{active:s.dateFilter==="all"}]),onClick:e[1]||(e[1]=l=>s.dateFilter="all")}," ทั้งหมด ",2),t("button",{class:g(["filter-btn",{active:s.dateFilter==="today"}]),onClick:e[2]||(e[2]=l=>s.dateFilter="today")}," วันนี้ ",2),t("button",{class:g(["filter-btn",{active:s.dateFilter==="yesterday"}]),onClick:e[3]||(e[3]=l=>s.dateFilter="yesterday")}," เมื่อวาน ",2),t("button",{class:"filter-btn date-picker-btn",onClick:e[4]||(e[4]=l=>s.showDatePicker=!0)},e[12]||(e[12]=[t("i",{class:"fas fa-calendar"},null,-1),b(" เลือกวันที่ ")]))]),s.showDatePicker?(c(),d("div",q,[t("div",A,[e[13]||(e[13]=t("h3",null,"เลือกวันที่",-1)),F(t("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=l=>s.selectedDate=l),max:s.today},null,8,G),[[p,s.selectedDate]]),t("div",J,[t("button",{onClick:e[6]||(e[6]=l=>s.showDatePicker=!1)},"ยกเลิก"),t("button",{onClick:e[7]||(e[7]=(...l)=>i.applyDateFilter&&i.applyDateFilter(...l))},"ตกลง")])])])):h("",!0)]),t("div",K,[(c(!0),d(U,null,L(i.filteredSeals,l=>{var y,m;return c(),d("div",{key:l.id,class:g(["seal-row",{active:((y=s.selectedSeal)==null?void 0:y.id)===l.id}])},[t("div",W,[t("div",X,o(l.seal_number),1),t("div",{class:g(["seal-status",l.status])},o(l.status),3),t("button",{class:"details-btn",onClick:v=>i.fetchSealDetails(l.id)},e[14]||(e[14]=[t("i",{class:"fas fa-info-circle"},null,-1),b(" รายละเอียด ")]),8,Y)]),((m=s.selectedSeal)==null?void 0:m.id)===l.id?(c(),d("div",Z,[t("div",$,[t("div",ee,[t("div",te,[e[15]||(e[15]=t("label",null,"ID:",-1)),t("span",null,o(s.selectedSeal.id),1)]),t("div",se,[e[16]||(e[16]=t("label",null,"สร้างเมื่อ:",-1)),t("span",null,o(i.formatDate(s.selectedSeal.created_at)),1)]),t("div",ae,[e[17]||(e[17]=t("label",null,"อัพเดทล่าสุด:",-1)),t("span",null,o(i.formatDate(s.selectedSeal.updated_at)),1)]),t("div",le,[e[18]||(e[18]=t("label",null,"Serial Number มิเตอร์:",-1)),t("span",null,o(s.selectedSeal.installed_serial||"-"),1)]),t("div",ie,[e[19]||(e[19]=t("label",null,"หมายเหตุ:",-1)),t("span",null,o(s.selectedSeal.installation_note||"-"),1)])]),s.selectedSeal.image1||s.selectedSeal.image2?(c(),d("div",re,[e[22]||(e[22]=t("h4",null,"รูปภาพการติดตั้ง",-1)),t("div",ne,[s.selectedSeal.image1?(c(),d("div",{key:0,class:"image-item",onClick:e[8]||(e[8]=v=>i.openImage(i.getImageUrl(s.selectedSeal.image1)))},[t("img",{src:i.getImageUrl(s.selectedSeal.image1),alt:"รูปที่ 1"},null,8,oe),e[20]||(e[20]=t("div",{class:"image-overlay"},[t("i",{class:"fas fa-search-plus"})],-1))])):h("",!0),s.selectedSeal.image2?(c(),d("div",{key:1,class:"image-item",onClick:e[9]||(e[9]=v=>i.openImage(i.getImageUrl(s.selectedSeal.image2)))},[t("img",{src:i.getImageUrl(s.selectedSeal.image2),alt:"รูปที่ 2"},null,8,de),e[21]||(e[21]=t("div",{class:"image-overlay"},[t("i",{class:"fas fa-search-plus"})],-1))])):h("",!0)])])):h("",!0)]),t("button",{class:"close-btn",onClick:e[10]||(e[10]=v=>s.selectedSeal=null)},e[23]||(e[23]=[t("i",{class:"fas fa-times"},null,-1)]))])):h("",!0)],2)}),128))])])])}const me=B(V,[["render",ce],["__scopeId","data-v-d7b9346a"]]);export{me as default};
